Starting complete Bridge Compliance ML Analysis...
Loading and exploring the dataset...
Dataset shape: (1123166, 20)

Columns: ['src_blockchain', 'src_transaction_hash', 'src_from_address', 'src_timestamp', 'dst_blockchain', 'dst_transaction_hash', 'dst_timestamp', 'depositor', 'recipient', 'dst_contract_address', 'input_amount', 'input_amount_usd', 'output_amount', 'output_amount_usd', 'quote_timestamp', 'fill_deadline', 'exclusivity_deadline', 'exclusive_relayer', 'fill_type', 'tornado_cash_label']

First few rows:
  src_blockchain                               src_transaction_hash  ... fill_type  tornado_cash_label
0       optimism  0xf444c27b7911a6e60a737b58c2549abe95db1a24072f...  ...         0                   0
1       optimism  0x81d9d6046d3dfde992a69892512de84abc271d667f70...  ...         0                   0
2       optimism  0x81d3beafe90db64a3e1d588b2a888ebb620aa794c42d...  ...         0                   0
3       optimism  0x34e1274f9ef686c9e9da2cdeac5c2e94e5cced227ec3...  ...         0                   0
4       optimism  0xac067edd3befa2f8f8e923fc42cd37fbb3bde7885836...  ...         0                   0

[5 rows x 20 columns]

Label distribution:
tornado_cash_label
0    1122770
1        396
Name: count, dtype: int64
Percentage of Tornado Cash matches: 0.04%

Missing values:
src_blockchain          0
src_transaction_hash    0
src_from_address        0
src_timestamp           0
dst_blockchain          0
dst_transaction_hash    0
dst_timestamp           0
depositor               0
recipient               0
dst_contract_address    0
input_amount            0
input_amount_usd        0
output_amount           0
output_amount_usd       0
quote_timestamp         0
fill_deadline           0
exclusivity_deadline    0
exclusive_relayer       0
fill_type               0
tornado_cash_label      0
dtype: int64

Data types:
src_blockchain           object
src_transaction_hash     object
src_from_address         object
src_timestamp             int64
dst_blockchain           object
dst_transaction_hash     object
dst_timestamp             int64
depositor                object
recipient                object
dst_contract_address     object
input_amount             object
input_amount_usd        float64
output_amount            object
output_amount_usd        object
quote_timestamp           int64
fill_deadline             int64
exclusivity_deadline      int64
exclusive_relayer        object
fill_type                 int64
tornado_cash_label        int64
dtype: object

Preprocessing data...
Features selected: ['src_blockchain', 'src_from_address', 'src_timestamp', 'dst_blockchain', 'dst_timestamp', 'dst_contract_address', 'input_amount', 'input_amount_usd', 'output_amount', 'output_amount_usd', 'quote_timestamp', 'fill_deadline', 'exclusivity_deadline', 'exclusive_relayer', 'fill_type']
Feature matrix shape: (1123166, 15)

Splitting data (test_size=0.2)...
Training set shape: (898532, 15)
Test set shape: (224634, 15)
Training set label distribution:
tornado_cash_label
0    898215
1       317
Name: count, dtype: int64

Training multiple machine learning models...

Training Random Forest...
Random Forest - Optimal threshold: 0.100, Recall: 0.342
Random Forest - AUC: 0.8439, Recall: 0.3418, Precision: 0.4576, F1: 0.3913
        Threshold: 0.100

Training Gradient Boosting...
Gradient Boosting - AUC: 0.7713, Recall: 0.0506, Precision: 0.2000, F1: 0.0808
        Threshold: 0.500

Training XGBoost...
XGBoost - Optimal threshold: 0.100, Recall: 0.241
XGBoost - AUC: 0.9296, Recall: 0.2405, Precision: 0.2568, F1: 0.2484
        Threshold: 0.100

Training Logistic Regression...
Logistic Regression - AUC: 0.6751, Recall: 0.0000, Precision: 0.0000, F1: 0.0000
        Threshold: 0.500

Training SVM...
SVM - AUC: 0.4225, Recall: 0.0000, Precision: 0.0000, F1: 0.0000
        Threshold: 0.500

Model Evaluation Summary:
================================================================================

Random Forest:
  Threshold: 0.100
  AUC Score: 0.8439
  Recall: 0.3418
  Precision: 0.4576
  F1 Score: 0.3913
  CV AUC: 0.8219 (+/- 0.0351)

Classification Report:
              precision    recall  f1-score   support

           0       1.00      1.00      1.00    224555
           1       0.46      0.34      0.39        79

    accuracy                           1.00    224634
   macro avg       0.73      0.67      0.70    224634
weighted avg       1.00      1.00      1.00    224634

Confusion Matrix:
[[224523     32]
 [    52     27]]

Gradient Boosting:
  Threshold: 0.500
  AUC Score: 0.7713
  Recall: 0.0506
  Precision: 0.2000
  F1 Score: 0.0808
  CV AUC: 0.8448 (+/- 0.0384)

Classification Report:
              precision    recall  f1-score   support

           0       1.00      1.00      1.00    224555
           1       0.20      0.05      0.08        79

    accuracy                           1.00    224634
   macro avg       0.60      0.53      0.54    224634
weighted avg       1.00      1.00      1.00    224634

Confusion Matrix:
[[224539     16]
 [    75      4]]

XGBoost:
  Threshold: 0.100
  AUC Score: 0.9296
  Recall: 0.2405
  Precision: 0.2568
  F1 Score: 0.2484
  CV AUC: 0.9131 (+/- 0.0451)

Classification Report:
              precision    recall  f1-score   support

           0       1.00      1.00      1.00    224555
           1       0.26      0.24      0.25        79

    accuracy                           1.00    224634
   macro avg       0.63      0.62      0.62    224634
weighted avg       1.00      1.00      1.00    224634

Confusion Matrix:
[[224500     55]
 [    60     19]]

Logistic Regression:
  Threshold: 0.500
  AUC Score: 0.6751
  Recall: 0.0000
  Precision: 0.0000
  F1 Score: 0.0000
  CV AUC: 0.6788 (+/- 0.0414)

Classification Report:
              precision    recall  f1-score   support

           0       1.00      1.00      1.00    224555
           1       0.00      0.00      0.00        79

    accuracy                           1.00    224634
   macro avg       0.50      0.50      0.50    224634
weighted avg       1.00      1.00      1.00    224634

Confusion Matrix:
[[224555      0]
 [    79      0]]

SVM:
  Threshold: 0.500
  AUC Score: 0.4225
  Recall: 0.0000
  Precision: 0.0000
  F1 Score: 0.0000
  CV AUC: 0.4723 (+/- 0.1676)

Classification Report:
              precision    recall  f1-score   support

           0       1.00      1.00      1.00    224555
           1       0.00      0.00      0.00        79

    accuracy                           1.00    224634
   macro avg       0.50      0.50      0.50    224634
weighted avg       1.00      1.00      1.00    224634

Confusion Matrix:
[[224555      0]
 [    79      0]]

Creating visualizations...

============================================================
BRIDGE COMPLIANCE ANALYSIS - TORNADO CASH DETECTION
============================================================

Dataset: across_bridge_data_labeled.csv
Total transactions: 1123166
Tornado Cash matches: 396
Match rate: 0.04%

Best performing model (by recall):
Model: Random Forest
Recall: 0.3418
Precision: 0.4576
F1 Score: 0.3913
AUC Score: 0.8439
Threshold: 0.100

Top 5 Most Important Features:
1. src_from_address: 0.1568
2. src_timestamp: 0.1312
3. dst_timestamp: 0.1274
4. quote_timestamp: 0.1164
5. output_amount_usd: 0.0995
Performing hyperparameter tuning for Random Forest...
Fitting 5 folds for each of 81 candidates, totalling 405 fits
Best parameters: {'max_depth': 10, 'min_samples_leaf': 2, 'min_samples_split': 10, 'n_estimators': 200}
Best CV score: 0.9349
Random Forest - Optimal threshold: 0.100, Recall: 0.089
Test AUC with best model: 0.9382
Test Recall: 0.0886, Precision: 0.8750
PS C:\Users\BabuPillai\OneDrive - Griffith University\Documents\GitHub\CrossChainAnomalyDetection>







